"use strict";function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function abstract(e,t,n){var s=void 0!==n&&void 0!==n.value;return s&&(n.value=function(){throw new AbstractMethodError(this.constructor.name==e.constructor.name?'The method "'+t+'" of "'+e.constructor.name+'" is abstract':'The method "'+t+'" of "'+this.constructor.name+'" is a "'+e.constructor.name+'" abstract method. It must be implemented')}),n}var _createDecoratedClass=function(){function e(e,t,n){for(var s=0;s<t.length;s++){var a=t[s],i=a.decorators,r=a.key;if(delete a.key,delete a.decorators,a.enumerable=a.enumerable||!1,a.configurable=!0,("value"in a||a.initializer)&&(a.writable=!0),i){for(var o=0;o<i.length;o++){var u=i[o];if("function"!=typeof u)throw new TypeError("The decorator for method "+a.key+" is of the invalid type "+typeof u);a=u(e,r,a)||a}if(void 0!==a.initializer){n[r]=a;continue}}Object.defineProperty(e,r,a)}}return function(t,n,s,a,i){return n&&e(t.prototype,n,a),s&&e(t,s,i),t}}(),_get=function(e,t,n){for(var s=!0;s;){var a=e,i=t,r=n;o=l=u=void 0,s=!1,null===a&&(a=Function.prototype);var o=Object.getOwnPropertyDescriptor(a,i);if(void 0!==o){if("value"in o)return o.value;var u=o.get;return void 0===u?void 0:u.call(r)}var l=Object.getPrototypeOf(a);if(null===l)return void 0;e=l,t=i,n=r,s=!0}},_createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var s=t[n];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}return function(t,n,s){return n&&e(t.prototype,n),s&&e(t,s),t}}(),HomeController=function(){function e(t){_classCallCheck(this,e),this.presenter=t,this.patchDetails=null,this.pedalboard=null,this.inicializarComponentes()}return _createClass(e,[{key:"inicializarComponentes",value:function(){this.patchDetails=new PatchDetailsComponent("patchDetails"),this.pedalboard=new PedalboardComponent("pedalboard",this)}},{key:"setPatchTitle",value:function(e){this.patchDetails.setName(e)}},{key:"setPatchNumber",value:function(e){this.patchDetails.setNumber(e)}},{key:"active",value:function(e){this.pedalboard.pedals[e].active()}},{key:"disable",value:function(e){this.pedalboard.pedals[e].disable()}},{key:"toogleEffectOf",value:function(e){this.presenter.toogleEffectOf(e)}}]),e}(),PatchDetailsComponent=function(){function e(t){_classCallCheck(this,e);var n=document.getElementById(t);this.nameElement=n.querySelector("#patchName"),this.numberElement=n.querySelector("#patchNumber")}return _createClass(e,[{key:"setName",value:function(e){this.nameElement.innerHTML=e}},{key:"setNumber",value:function(e){10>e&&(e="0"+e),this.numberElement.innerHTML=e}}]),e}(),PedalboardComponent=function e(t,n){var s=this;_classCallCheck(this,e),this.pedals=document.getElementById(t).querySelectorAll("guitar-pedal");for(var a=function(e){var t=s.pedals[e];t.click=function(){return n.toogleEffectOf(e)}},i=0;i<this.pedals.length;i++)a(i)},Pagina=function(){function e(t){_classCallCheck(this,e),this.router=t}return _createClass(e,[{key:"barra",value:function(){return this.router.barra}},{key:"router",value:function(){return this.router}},{key:"inicializar",value:function(){}},{key:"finalizar",value:function(){}}]),e}(),HomePagina=function(e){function t(e){_classCallCheck(this,t),_get(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e),this.controller=new HomeController(this),this.pedal=null}return _inherits(t,e),_createClass(t,[{key:"inicializar",value:function(e){var t=this,n=function(e){return new Promise(function(t,n){return t(e[0])})},s=function(e){console.log(e),t.pedal=e,t.pedal.on(),t.pedal.addListenner(t),t.pedal.send(ZoomGSeriesMessages.REQUEST_CURRENT_PATCH_NUMBER())},a=new PedalLoader(n);a.load().then(s)}},{key:"finalizar",value:function(){this.pedal.off()}},{key:"onChange",value:function(e){var t=this;e.getBy(CommonCause.ACTIVE_EFFECT).forEach(function(e){return t.updateEffect(e,CommonCause.ACTIVE_EFFECT)}),e.getBy(CommonCause.DISABLE_EFFECT).forEach(function(e){return t.updateEffect(e,CommonCause.DISABLE_EFFECT)}),e.getBy(CommonCause.TO_PATCH).forEach(function(e){return t.setPatch(e)}),e.getBy(CommonCause.SET_PARAM).forEach(function(e){return console.log(t.pedal)}),e.getBy(CommonCause.PATCH_NAME).forEach(function(e){t.controller.setPatchTitle(e.details.value)}),e.getBy(CommonCause.PATCH_NUMBER).forEach(function(e){t.controller.setPatchNumber(e.details.value)})}},{key:"updateEffect",value:function(e,t){var n=e.details.patch,s=e.details.effect;n==this.pedal.multistomp().getIdCurrentPatch()&&(t==CommonCause.ACTIVE_EFFECT?this.controller.active(s):this.controller.disable(s))}},{key:"setPatch",value:function(e){var t=e.details.patch;this.pedal.send(ZoomGSeriesMessages.REQUEST_SPECIFIC_PATCH_DETAILS(t)),this.controller.setPatchNumber(t)}},{key:"toogleEffectOf",value:function(e){this.pedal.toogleEffect(e)}}]),t}(Pagina),PaginaRouter=function(){function e(){_classCallCheck(this,e),this.historico=new Historico,this.paginas={},this._adicionarPaginasEm(this.paginas)}return _createClass(e,[{key:"_adicionarPaginasEm",value:function(e){e.home=new HomePagina(this)}},{key:"_irParaPagina",value:function(e,t){var n=this.historico.atual();n&&n.pagina.finalizar(),n=new PaginaHistorico(this.paginas[e],t),this.historico.atual(n),n.pagina.inicializar(t)}},{key:"irParaPaginaHome",value:function(){this._irParaPagina("home")}},{key:"irParaPaginaAnterior",value:function(){if(!(this.historico.size()<=1)){var e=this.historico.voltar();e.pagina.finalizar(),e=this.historico.atual(),e.pagina.inicializar(e.parametros)}}}]),e}(),Historico=function(){function e(){_classCallCheck(this,e),this.pilha=new Pilha}return _createClass(e,[{key:"atual",value:function(e){return e?void this.pilha.add(e):this.pilha.last()}},{key:"anterior",value:function(){return this.pilha.last()}},{key:"voltar",value:function(){return this.pilha.pop()}},{key:"size",value:function(){return this.pilha.size()}}]),e}(),Pilha=function(){function e(){_classCallCheck(this,e),this.lista=[]}return _createClass(e,[{key:"add",value:function(e){this.lista.push(e)}},{key:"last",value:function(){return this.lista[this.lista.length-1]}},{key:"pop",value:function(){return this.lista.pop()}},{key:"size",value:function(){return this.lista.length}}]),e}(),PaginaHistorico=function t(e,n){_classCallCheck(this,t),this.pagina=e,this.parametros=n},Includer=function(){function e(t){_classCallCheck(this,e);var n=document.querySelector('link[rel="import"][href^="'+t+'"]');this.template=n["import"].querySelector("template")}return _createClass(e,[{key:"gerarEm",value:function(e){var t=document.importNode(this.template.content,!0);e.appendChild(t)}}]),e}(),PedalGerador=function(){function e(){_classCallCheck(this,e),this.pedals=this.getContentOf("src/app/template/pedal/zoom-g3v2.html"),console.log(this.pedals)}return _createClass(e,[{key:"getContentOf",value:function(e){return document.querySelector('link[rel="import"][href^="'+e+'"]')}},{key:"generateFor",value:function(e){var t=this.knobsTemplateOf(e),n=document.createElement("guitar-pedal"),s=document.importNode(t.content,!0);return n.addKnobs(s),n.name=e,n}},{key:"knobsTemplateOf",value:function(e){return this.pedals["import"].querySelector('template[data-name="'+e+'"]')}},{key:"pedalsNames",value:function t(){for(var t=[],e=this.pedals["import"].querySelectorAll("template"),n=0;n<e.length;n++){var s=e[n];t.push(s.getAttribute("data-name"))}return t}}]),e}(),ErrorClass=function(e){function t(e){_classCallCheck(this,t),_get(Object.getPrototypeOf(t.prototype),"constructor",this).call(this),Error.hasOwnProperty("captureStackTrace")?Error.captureStackTrace(this,this.constructor):Object.defineProperty(this,"stack",{value:(new Error).stack}),Object.defineProperty(this,"message",{value:e})}return _inherits(t,e),t}(Error),ImplemetationError=function(e){function t(){_classCallCheck(this,t),_get(Object.getPrototypeOf(t.prototype),"constructor",this).apply(this,arguments)}return _inherits(t,e),t}(ErrorClass),DeviceNotFoundError=function(e){function t(){_classCallCheck(this,t),_get(Object.getPrototypeOf(t.prototype),"constructor",this).apply(this,arguments)}return _inherits(t,e),t}(ErrorClass),AbstractClassError=function(e){function t(e){_classCallCheck(this,t),_get(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,'The "'+e.constructor.name+'" class is abstract')}return _inherits(t,e),t}(ErrorClass),AbstractMethodError=function(e){function t(e){_classCallCheck(this,t),_get(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e)}return _inherits(t,e),t}(ErrorClass),BinarioUtil=function(){function e(){_classCallCheck(this,e)}return _createClass(e,null,[{key:"byteArrayToHex",value:function(e){var t=" ",n=!0,s=!1,a=void 0;try{for(var i,r=e[Symbol.iterator]();!(n=(i=r.next()).done);n=!0){var o=i.value;t+=o.toString(16).toUpperCase()+" "}}catch(u){s=!0,a=u}finally{try{!n&&r["return"]&&r["return"]()}finally{if(s)throw a}}return"["+t+"]"}}]),e}(),MessagesCollection=function(){function e(){_classCallCheck(this,e),this.messages=new Array}return _createClass(e,[{key:"add",value:function(e){return this.messages.push(e),this}},{key:"concatWith",value:function(e){var t=this;return e.forEach(function(e){return t.add(e)}),this}},{key:Symbol.iterator,value:function(){return this.messages[Symbol.iterator]()}},{key:"forEach",value:function(e){this.messages.forEach(e)}},{key:"toString",value:function(){var e="",t=!0,n=!1,s=void 0;try{for(var a,i=this.messages[Symbol.iterator]();!(t=(a=i.next()).done);t=!0){var r=a.value;e+=r.toString()}}catch(o){n=!0,s=o}finally{try{!t&&i["return"]&&i["return"]()}finally{if(n)throw s}}return e}}]),e}(),MidiMessageTester=function(){function e(t){_classCallCheck(this,e),this.message=t}return _createClass(e,[{key:"init",value:function(){return this.tests=new Tests,this}},{key:"test",value:function(){return this.tests.finalResult()}},{key:"isLessThen",value:function(e){return this.tests.add(this.message.length<e.length),this}},{key:"startingWith",value:function(e){if(!(e.length<=this.message.length))return this.tests.add(!1),this;for(var t=0;t<e.length;t++)e[t]!=this.message[t]&&this.tests.add(!1);return this.tests.add(!0),this}},{key:"sizeIs",value:function(e){return this.tests.add(this.message.length==e),this}},{key:"endingWith",value:function(e){if(!(e.length<=this.message.length))return this.tests.add(!1),this;for(var t=1;t<=e.length;t++)e[e.length-t]!=this.message[this.message.length-t]&&this.tests.add(!1);return this.tests.add(!0),this}}]),e}(),Tests=function(){function e(){_classCallCheck(this,e),this.result=!0}return _createClass(e,[{key:"add",value:function(e){0!=this.result&&(this.result=e)}},{key:"finalResult",value:function(){return this.result}}]),e}(),Optional=function(){function e(t){_classCallCheck(this,e),this.content=t}return _createClass(e,[{key:"isPresent",value:function(){return null!==this.content}},{key:"get",value:function(){if(!this.isPresent())throw new Error("NullPointerException");return this.content}}],[{key:"of",value:function(t){return new e(t)}},{key:"empty",value:function(){return new e(null)}}]),e}(),MultistompChanger=function(){function e(t){_classCallCheck(this,e),this.controller=t}return _createClass(e,[{key:"attempt",value:function(e){if(e.is(CommonCause.TO_PATCH))this.controller.toPatch(e.details.patch);else if(this.isActiveEffectCurrentPatch(e))this.controller.activeEffect(e.details.effect);else if(this.isActiveEffectSpecificPatch(e))this.controller.multistomp().patchs[e.details.patch].effects[e.details.effect].active();else if(this.isDisableEffectCurrentPatch(e))this.controller.disableEffect(e.details.effect);else if(this.isDisableEffectSpecificPatch(e))this.controller.multistomp().patchs[e.details.patch].effects[e.details.effect].disable();else if(e.is(CommonCause.SET_PARAM)){var t=e.details.effect,n=e.details.param,s=e.details.value;this.controller.setEffectParam(t,n,s)}else e.is(CommonCause.PATCH_NAME)&&(this.controller.multistomp().currentPatch().name=e.details.value)}},{key:"isActiveEffectCurrentPatch",value:function(e){return e.is(CommonCause.ACTIVE_EFFECT)&&e.details.patch==Messages.Details.NULL}},{key:"isDisableEffectCurrentPatch",value:function(e){return e.is(CommonCause.DISABLE_EFFECT)&&e.details.patch==Messages.Details.NULL}},{key:"isActiveEffectSpecificPatch",value:function(e){e.is(CommonCause.ACTIVE_EFFECT)&&e.details.patch!=Details.NULL}},{key:"isDisableEffectSpecificPatch",value:function(e){e.is(CommonCause.ACTIVE_EFFECT)&&e.details.patch!=Details.NULL}}]),e}(),PedalCompany=function(){function e(t){_classCallCheck(this,e),this.name=t}return _createClass(e,[{key:"getName",value:function(){return this.name}},{key:"toString",value:function(){return this.name}}]),e}();PedalCompany.NULL=new PedalCompany("Unknown Company"),PedalCompany.ZoomCorp=new PedalCompany("Zoom Corporation"),PedalCompany.Line6=new PedalCompany("Line 6"),PedalCompany.Roland=new PedalCompany("Roland Corporation");var PedalController=function(){function e(t,n){_classCallCheck(this,e),this.controllerListenners=new Array,this.realMultistompListenners=new Array,this.realChange=!1,this.started=!1,this.pedal=n,this.connection=t,this.connection.setListenner(this),this.pedal.addListenner(this),this.controllerListenners.push(new Log("Controller")),this.realMultistompListenners.push(new Log("Real Multistomp"))}return _createClass(e,[{key:"on",value:function(){this.started||(this.started=!0,this.connection.start(),this.connection.send(this.pedal.start()),this.realChange=!1)}},{key:"off",value:function(){this.started&&(this.started=!1,this.connection.stop())}},{key:"hasStarted",value:function(){return this.started}},{key:"multistomp",value:function(){return this.pedal}},{key:"nextPatch",value:function(){this.pedal.nextPatch()}},{key:"beforePatch",value:function(){this.pedal.beforePatch()}},{key:"toPatch",value:function(e){this.pedal.toPatch(e)}},{key:"toogleEffect",value:function(e){this.pedal.currentPatch().effects[e].toggle()}},{key:"hasActived",value:function(e){return this.pedal.currentPatch().effects[e].hasActived()}},{key:"activeEffect",value:function(e){this.pedal.currentPatch().effects[e].active()}},{key:"disableEffect",value:function(e){this.pedal.currentPatch().effects[e].disable()}},{key:"setEffectParam",value:function(e,t,n){this.pedal.currentPatch().effects[e].params[t].setValue(n)}},{key:"getAmountEffects",value:function(){return this.pedal.currentPatch().effects.length}},{key:"addListenner",value:function(e){this.pedal.addListenner(e)}},{key:"toString",value:function(){var e="State: ";return e+=started?"On":"Off",e+="\n",e+this.pedal.toString()}},{key:"onChange",value:function(e){return this.realChange?void(this.realChange=!1):(this.connection.send(e),void this.notify(this.controllerListenners,e))}},{key:"update",value:function(e){this.realChange=!0;var t=new MultistompChanger(this);e.forEach(function(e){return t.attempt(e)}),this.notify(this.realMultistompListenners,e)}},{key:"notify",value:function(e,t){var n=!0,s=!1,a=void 0;try{for(var i,r=e[Symbol.iterator]();!(n=(i=r.next()).done);n=!0){var o=i.value;o.onChange(t)}}catch(u){s=!0,a=u}finally{try{!n&&r["return"]&&r["return"]()}finally{if(s)throw a}}}},{key:"sendMessage",value:function(e){this.connection.send(e)}},{key:"send",value:function(e){this.connection.send(e),this.realChange=!0}}]),e}(),PedalGenerator=function(){function e(t){_classCallCheck(this,e),this.midiConnection=t}return _createClass(e,[{key:"generateFor",value:function(e){var t=MultistompFactory.For(e);return new PedalController(this.midiConnection,t)}}]),e}(),PedalLoader=function(){function e(t){_classCallCheck(this,e),this.selectPedalPromise=t,this.midiSystem=new MidiSystem}return _createClass(e,[{key:"load",value:function(){return this.midiSystem.start().then(this.findPedals.bind(this)).then(this.selectPedal.bind(this)).then(this.findPedalDevices.bind(this)).then(this.generateConnection.bind(this)).then(this.generateMultistomp.bind(this))}},{key:"findPedals",value:function(){var e=new PedalsFinder(this.midiSystem),t=e.find(PedalType.values);return new Promise(function(e){return e(t)})}},{key:"selectPedal",value:function(e){return this.selectPedalPromise(e)}},{key:"findPedalDevices",value:function(e){var t=this.midiSystem.devicesOf(e);return new Promise(function(n){n({pedalType:e,pedalDevices:t})})}},{key:"generateConnection",value:function(e){var t=e.pedalType,n=e.pedalDevices,s=new MidiConnection(t,n);return new Promise(function(e){e({connection:s,pedalType:t})})}},{key:"generateMultistomp",value:function(e){var t=e.connection,n=e.pedalType,s=new PedalGenerator(t),a=s.generateFor(n);return new Promise(function(e){return e(a)})}}]),e}(),PedalsFinder=function(){function e(t){_classCallCheck(this,e),this.midiSystem=t}return _createClass(e,[{key:"find",value:function(e){var t=new Array,n=!0,s=!1,a=void 0;try{for(var i,r=e[Symbol.iterator]();!(n=(i=r.next()).done);n=!0){var o=i.value;this.isConnected(o)&&t.push(o)}}catch(u){s=!0,a=u}finally{try{!n&&r["return"]&&r["return"]()}finally{if(s)throw a}}return t}},{key:"isConnected",value:function(e){return 0!=this.findDevicesFor(e).length}},{key:"findDevicesFor",value:function(e){var t=new Array,n=void 0,s=!0,a=!1,i=void 0;try{for(var r,o=this.midiSystem.midiDevices[Symbol.iterator]();!(s=(r=o.next()).done);s=!0)n=r.value,n.name.includes(e.USBName)&&t.push(n)}catch(u){a=!0,i=u}finally{try{!s&&o["return"]&&o["return"]()}finally{if(a)throw i}}return t}}]),e}(),MidiMessage=function n(){_classCallCheck(this,n),this.message=[];var e=!0,t=!1,s=void 0;try{for(var a=arguments.length,i=Array(a),r=0;a>r;r++)i[r]=arguments[r];for(var o,u=i[Symbol.iterator]();!(e=(o=u.next()).done);e=!0){var l=o.value;this.message.push(l)}}catch(c){t=!0,s=c}finally{try{!e&&u["return"]&&u["return"]()}finally{if(t)throw s}}},MidiMessages=function(e){function t(){_classCallCheck(this,t),_get(Object.getPrototypeOf(t.prototype),"constructor",this).apply(this,arguments)}return _inherits(t,e),t}(MessagesCollection),MidiSystem=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"start",value:function(){return navigator.requestMIDIAccess({sysex:!0}).then(this.onStartPromised.bind(this),this.onError.bind(this))}},{key:"onStartPromised",value:function(e){return this.onStart(e),new Promise(function(e){return e()})}},{key:"onStart",value:function(e){this.midiInputs=e.inputs,this.midiOutputs=e.outputs,console.log("Connected")}},{key:"onError",value:function(e){console.log(e),console.log("Deu pau :/")}},{key:"devicesOf",value:function(e){return{input:this.inputMidiDeviceOf(e),output:this.outputMidiDeviceOf(e)}}},{key:"inputMidiDeviceOf",value:function(e){return this.midiDeviceOfType(e,this.midiInputs)}},{key:"outputMidiDeviceOf",value:function(e){return this.midiDeviceOfType(e,this.midiOutputs)}},{key:"midiDeviceOfType",value:function(e,t){var n=!0,s=!1,a=void 0;try{for(var i,r=t.values()[Symbol.iterator]();!(n=(i=r.next()).done);n=!0){var o=i.value;if(o.name.includes(e.USBName))return Optional.of(o)}}catch(u){s=!0,a=u}finally{try{!n&&r["return"]&&r["return"]()}finally{if(s)throw a}}return Optional.empty()}},{key:"midiDevices",get:function(){var e=[],t=!0,n=!1,s=void 0;try{for(var a,i=this.midiInputs.values()[Symbol.iterator]();!(t=(a=i.next()).done);t=!0){var r=a.value;e.push(r)}}catch(o){n=!0,s=o}finally{try{!t&&i["return"]&&i["return"]()}finally{if(n)throw s}}var u=!0,l=!1,c=void 0;try{for(var h,f=this.midiOutputs.values()[Symbol.iterator]();!(u=(h=f.next()).done);u=!0){var d=h.value;e.push(d)}}catch(o){l=!0,c=o}finally{try{!u&&f["return"]&&f["return"]()}finally{if(l)throw c}}return e}}]),e}(),MidiConnection=function(){function e(t,n){_classCallCheck(this,e),this.listenner=Optional.empty(),this.analyzer=Optional.empty(),this.transmition=new MidiTransmition(n),this.transmition.setOnDataListenerReceived(this),this.codification=MessageCodificationFactory.For(t)}return _createClass(e,[{key:"start",value:function(){this.transmition.start()}},{key:"stop",value:function(){this.transmition.stop()}},{key:"send",value:function(e){var t=!0,n=!1,s=void 0;try{for(var a,i=this.generateMidiMessages(e)[Symbol.iterator]();!(t=(a=i.next()).done);t=!0){var r=a.value;this.sendMidiMessage(r)}}catch(o){n=!0,s=o}finally{try{!t&&i["return"]&&i["return"]()}finally{if(n)throw s}}}},{key:"generateMidiMessages",value:function(e){return this.codification.encode(e)}},{key:"sendMidiMessage",value:function(e){console.log("PASSAR PARA ANALIZER"),console.log("MIDI sended: "),console.log(" "+BinarioUtil.byteArrayToHex(e.message)),this.transmition.send(e.message)}},{key:"setListenner",value:function(e){this.listenner=Optional.of(e)}},{key:"onDataReceived",value:function(e){if(console.log("PASSAR PARA ANALIZER"),console.log("MIDI received: "),console.log(" "+BinarioUtil.byteArrayToHex(e)),this.analyzer.isPresent()&&this.analyzer.get().analyze(e),!this.codification.isForThis(e))return void console.log(" unknown ");var t=this.codification.decode(e);this.listenner.isPresent()&&this.listenner.get().update(t)}}]),e}();MidiConnection.OnUpdateListenner=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"update",value:function(e){}}]),e}();var MidiMessagesAnalyzer=function(){function e(t,n){_classCallCheck(this,e),this.pedal=t,this.pedal.connection.analyzer=Optional.of(this),this.started=!1,this.messages=void 0,this.changes=n}return _createClass(e,[{key:"start",value:function(){for(this.started=!0,this.messages=[];this.changes.hasNext();)this.changes.next()}},{key:"stop",value:function(){this.started=!1}},{key:"analyze",value:function(e){this.started&&this.messages.push(e)}}]),e}(),PedalChanges=function(){function e(t,n){_classCallCheck(this,e),this.totalChanges=n,this.currentChange=0,this.pedal=t}return _createClass(e,[{key:"init",value:function(){}},{key:"hasNext",value:function(){return this.currentChange<this.totalChanges}},{key:"next",value:function(){this.currentChange++,this.nextImp()}},{key:"nextImp",value:function(){}}]),e}(),ZoomGSeriesDetectPedalChanges=function(e){function t(e){_classCallCheck(this,t),_get(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e,25)}return _inherits(t,e),_createClass(t,[{key:"init",value:function(){this.pedal.toPatch(8),this.zeroParams(0),this.pedal.send(ZoomGSeriesMessages.SET_EFFECT(1,117)),this.pedal.send(ZoomGSeriesMessages.SET_EFFECT(2,117)),this.pedal.send(ZoomGSeriesMessages.SET_EFFECT(3,117)),this.pedal.send(ZoomGSeriesMessages.SET_EFFECT(4,117)),this.pedal.send(ZoomGSeriesMessages.SET_EFFECT(5,117))}},{key:"zeroParams",value:function(e){this.pedal.setEffectParam(e,0,0),this.pedal.setEffectParam(e,1,0),this.pedal.setEffectParam(e,2,0),this.pedal.setEffectParam(e,3,0),this.pedal.setEffectParam(e,4,0),this.pedal.setEffectParam(e,5,0),this.pedal.setEffectParam(e,6,0),this.pedal.setEffectParam(e,7,0),this.pedal.setEffectParam(e,8,0)}},{key:"nextImp",value:function(){this.pedal.send(ZoomGSeriesMessages.SET_EFFECT(1,this.currentPatch)),this.zeroParams(0)}}]),t}(PedalChanges),MessageCodification=function(){function e(t,n){_classCallCheck(this,e),this.encoder=t,this.decoder=n}return _createClass(e,[{key:"encode",value:function(e){return this.encoder.encode(e)}},{key:"decode",value:function(e){return this.decoder.decode(e)}},{key:"isForThis",value:function(e){return this.decoder.isForThis(e)}}]),e}(),MessageCodificationFactory=function(){function e(){_classCallCheck(this,e)}return _createClass(e,null,[{key:"For",value:function(e){if(PedalType.G3==e)return new MessageCodification(new ZoomGSeriesMessageEncoder,new ZoomGSeriesMessageDecoder);throw new Error("MessageCodification not found for: "+e)}}]),e}(),MidiTransmition=function(){function e(t){if(_classCallCheck(this,e),!t.input.isPresent()||!t.output.isPresent())throw new DeviceNotFoundError("Midi device(s) not found for: "+pedalType+" ("+pedalType.getUSBName()+")");this.sender=new MidiTransmitionSender(t.output.get()),this.reader=new MidiTransmitionReader(t.input.get())}return _createClass(e,[{key:"start",value:function(){this.sender.start(),this.reader.start()}},{key:"stop",value:function(){this.sender.stop(),this.reader.stop()}},{key:"setOnDataListenerReceived",value:function(e){this.reader.setListenner(e)}},{key:"send",value:function(e){this.sender.send(e)}}]),e}(),AbstractMidiTransmition=function(){function e(t){_classCallCheck(this,e),this.device=t}return _createClass(e,[{key:"start",value:function(){this.device.open()}},{key:"stop",value:function(){this.device.close()}}]),e}(),MidiTransmitionReader=function(e){function t(e){var n=this;_classCallCheck(this,t),_get(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e),this.device.onmidimessage=function(e){return n.send(e)}}return _inherits(t,e),_createClass(t,[{key:"setListenner",value:function(e){this.listenner=e}},{key:"send",value:function(e){this.listenner.onDataReceived(e.data)}}]),t}(AbstractMidiTransmition),MidiTransmitionSender=function(e){function t(e){_classCallCheck(this,t),_get(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e)}return _inherits(t,e),_createClass(t,[{key:"send",value:function(e){this.device.send(e)}}]),t}(AbstractMidiTransmition),MidiMessagesGenerator=function(){function e(t,n){_classCallCheck(this,e),this.messages=t,this.encoder=n,this.messagesGenerated=new MidiMessages}return _createClass(e,[{key:"forEachOfType",value:function(e){var t=this,n=function(n){var s=t._generateMessages(n,e);t.messagesGenerated.concatWith(s)};return{generate:n}}},{key:"generateMidiMessages",value:function(){return this.messagesGenerated}},{key:"_generateMessages",value:function(e,t){e=this._bind(e);var n=new MidiMessages,s=this.messages.getBy(t);return s.forEach(function(s){n.concatWith(e(s,t))}),n}},{key:"_bind",value:function(e){return e.bind(this.encoder)}}]),e}(),PedalType=function(){function e(t,n,s){_classCallCheck(this,e),this.name=t,this.company=n,this.USBName=s,e.values.push(this)}return _createClass(e,null,[{key:"values",value:new Array,enumerable:!0}]),_createClass(e,[{key:"getId",value:function(){return this.id}},{key:"getCompany",value:function(){return this.company}},{key:"toString",value:function(){return this.name+" - "+this.company.toString()}},{key:"getUSBName",value:function(){return this.USBName}}]),e}();PedalType.Null=new PedalType("Unknown Pedal",PedalCompany.NULL,"Pedal Unknown is unimplemented"),PedalType.G2Nu=new PedalType("Zoom G2Nu",PedalCompany.ZoomCorp,"G2Nu/G2.1Nu"),PedalType.G3=new PedalType("Zoom G3v2.0",PedalCompany.ZoomCorp,"ZOOM G Series");var CommonCause=function s(){_classCallCheck(this,s)};CommonCause.TO_PATCH="TO_PATCH",CommonCause.GENERAL_VOLUME="GENERAL_VOLUME",CommonCause.PATCH_NUMBER="PATCH_NUMBER",CommonCause.PATCH_VOLUME="PATCH_VOLUME",CommonCause.PATCH_NAME="PATCH_NAME",CommonCause.ACTIVE_EFFECT="ACTIVE_EFFECT",CommonCause.DISABLE_EFFECT="DISABLE_EFFECT",CommonCause.SET_PARAM="SET_PARAM";var Messages=function(e){function t(){_classCallCheck(this,t),_get(Object.getPrototypeOf(t.prototype),"constructor",this).apply(this,arguments)}return _inherits(t,e),_createClass(t,[{key:"getBy",value:function(e){var n=new t,s=!0,a=!1,i=void 0;try{for(var r,o=this[Symbol.iterator]();!(s=(r=o.next()).done);s=!0){var u=r.value;u.is(e)&&n.add(u)}}catch(l){a=!0,i=l}finally{try{!s&&o["return"]&&o["return"]()}finally{if(a)throw i}}return n}}]),t}(MessagesCollection);Messages.Details=function(){function e(){_classCallCheck(this,e),this.patch=e.NULL,this.effect=e.NULL,this.param=e.NULL,this.value=e.NULL}return _createClass(e,[{key:"toString",value:function(){var t="";return this.patch!=e.NULL&&(t+=" patch="+this.patch),this.effect!=e.NULL&&(t+=" effect="+this.effect),this.param!=e.NULL&&(t+=" param="+this.param),this.value!=e.NULL&&(t+=" value="+this.value),t}}],[{key:"NULL",value:-1,enumerable:!0}]),e}(),Messages.Message=function(){function e(t,n){_classCallCheck(this,e),void 0===n?this._MessageCause(t):this._MessageCauseDetails(t,n)}return _createClass(e,[{key:"_MessageCause",value:function(e){this._MessageCauseDetails(e,new Messages.Details)}},{key:"_MessageCauseDetails",value:function(e,t){this.cause=e,this.details=t}},{key:"details",value:function(){return this.details}},{key:"is",value:function(e){return this.cause==e}},{key:"toString",value:function(){var e=this.cause+": ("+this.details+")";return e}}]),e}();var Effect=function(){function e(t,n){_classCallCheck(this,e),this.state=!1,this.params=new Array,this.listenner=Optional.empty(),this.midiId=t,this.name=n}return _createClass(e,[{key:"getMidiId",value:function(){return this.midiId}},{key:"getName",value:function(){return this.name}},{key:"active",value:function(){this.setState(!0)}},{key:"disable",value:function(){this.setState(!1)}},{key:"toggle",value:function(){this.hasActived()?this.disable():this.active()}},{key:"setState",value:function(e){this.state=e;var t=new Details(Details.TypeChange.PEDAL_STATUS,e?1:0),n=new ChangeMessage(MultistompCause.EFFECT,this,t);this.notify(n)}},{key:"hasActived",value:function(){return this.state}},{key:"addParam",value:function(e){this.params.push(e),e.setListenner(this)}},{key:"toString",value:function(){var t=this.name+": "+this.midiId+" "+e.name+" - ";t+=this.state?"Actived":"Disabled";var n=!0,s=!1,a=void 0;try{for(var i,r=this.params[Symbol.iterator]();!(n=(i=r.next()).done);n=!0){var o=i.value;t+=o.toString()}}catch(u){s=!0,a=u}finally{try{!n&&r["return"]&&r["return"]()}finally{if(s)throw a}}return t+=")"}},{key:"setListenner",value:function(e){this.listenner=Optional.of(e)}},{key:"onChange",value:function(e){var t=new ChangeMessage(MultistompCause.SUPER,this,e);this.notify(t)}},{key:"notify",value:function(e){this.listenner.isPresent()&&this.listenner.get().onChange(e)}}]),e}(),Multistomp=function(){function e(){_classCallCheck(this,e),this.listenners=new Array,this.patchs=new Array,this.idCurrentPatch=0}return _createDecoratedClass(e,[{key:"getPedalType",decorators:[abstract],value:function(){}},{key:"addPatch",value:function(e){this.patchs.push(e),e.setListenner(this)}},{key:"currentPatch",value:function(){try{return this.patchs[this.idCurrentPatch]}catch(e){throw new ImplemetationError("This multistomp havent any Patch. \nAdd the Patchs in the Pedal Construtor: "+this.name)}}},{key:"getIdCurrentPatch",value:function(){return this.idCurrentPatch}},{key:"nextPatch",value:function(){this.toPatch(this.idCurrentPatch+1)}},{key:"beforePatch",value:function(){this.toPatch(this.idCurrentPatch-1)}},{key:"toPatch",value:function(e){e>=this.patchs.length?e=0:0>e&&(e=this.patchs.length-1),this.idCurrentPatch=e;var t=new Details(Details.TypeChange.PATCH_NUMBER,this.idCurrentPatch),n=new ChangeMessage(MultistompCause.MULTISTOMP,this,t);this.notify(n)}},{key:"patchs",value:function(e){function t(){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(){return patchs})},{key:"toString",value:function(){var t="";t+="Multistomp: "+e.name+"\n",t+=" - Current Patch: "+this.currentPatch().toString()+"\n",t+=" - Effects: \n";var n=!0,s=!1,a=void 0;try{for(var i,r=this.currentPatch().effects[Symbol.iterator]();!(n=(i=r.next()).done);n=!0){var o=i.value;t+="  |- "+o.toString()+"\n"}}catch(u){s=!0,a=u}finally{try{!n&&r["return"]&&r["return"]()}finally{if(s)throw a}}return t}},{key:"addListenner",value:function(e){this.listenners.push(e)}},{key:"listenners",value:function(){return this.listenners}},{key:"onChange",value:function(e){var t=new ChangeMessage(MultistompCause.SUPER,this,e);this.notify(t)}},{key:"notify",value:function(e){var t=MultistompMessagesConverter.convert(e);this.listenners.forEach(function(e){return e.onChange(t)})}},{key:"start",value:function(){}}]),e}(),MultistompMessagesConverter=function(){function e(){_classCallCheck(this,e);

}return _createClass(e,null,[{key:"convert",value:function(e){var t=null,n=new Messages.Details;return e.is(MultistompCause.MULTISTOMP)?t=this.convertToPatch(e,n):e.is(MultistompCause.PATCH)?t=this.convertPatch(e,n):e.is(MultistompCause.EFFECT)?t=this.convertStatusEffect(e,n):e.is(MultistompCause.PARAM)&&(t=this.convertSetParam(e,n)),null!=t?(new Messages).add(t):new Messages}},{key:"convertToPatch",value:function(e,t){return t.patch=e.causer.getIdCurrentPatch(),new Messages.Message(CommonCause.TO_PATCH,t)}},{key:"convertPatch",value:function(e,t){return!t.type==Details.TypeChange.PATCH_NAME?new Messages:(t.value=e.realMessage().details.newValue,new Messages.Message(CommonCause.PATCH_NAME,t))}},{key:"convertStatusEffect",value:function(e,t){var n=e.nextMessage.causer;t.patch=e.causer.patchs.indexOf(n);var s=e.realMessage().causer,a=n.effects.indexOf(s);t.effect=a;var i=s.hasActived()?CommonCause.ACTIVE_EFFECT:CommonCause.DISABLE_EFFECT;return new Messages.Message(i,t)}},{key:"convertSetParam",value:function(e,t){var n=e.nextMessage.causer,s=e.nextMessage.nextMessage.causer,a=n.effects.indexOf(s);return t.effect=a,t.param=s.params.indexOf(e.realMessage().causer),t.value=e.realMessage().causer.getValue(),new Messages.Message(CommonCause.SET_PARAM,t)}}]),e}(),Param=function(){function e(t,n,s,a,i){_classCallCheck(this,e),this.stepByStep=1,this.listenner=Optional.empty(),this.name=t,this.minValue=n,this.maxValue=s,this.setCurrentValue(a),this.stepByStep=i}return _createClass(e,[{key:"setCurrentValue",value:function(e){this.isValidValue(e)||(e=e>this.maxValue?this.maxValue:this.minValue),this.currentValue=e;var t=new Details(Details.TypeChange.PARAM,this.currentValue),n=new ChangeMessage(MultistompCause.PARAM,this,t);this.notify(n)}},{key:"isValidValue",value:function(e){return!(e<this.minValue||e>this.maxValue)}},{key:"notify",value:function(e){this.listenner.isPresent()&&this.listenner.get().onChange(e)}},{key:"getName",value:function(){return this.name}},{key:"getValue",value:function(){return this.currentValue}},{key:"setValue",value:function(e){this.setCurrentValue(e)}},{key:"addValue",value:function(){var e=this.currentValue+this.stepByStep;this.isValidValue(e)&&this.setValue(e)}},{key:"getMinValue",value:function(){return this.minValue}},{key:"getMaxValue",value:function(){return this.maxValue}},{key:"setListenner",value:function(e){this.listenner=Optional.of(e)}},{key:"toString",value:function(){return this.name+" = "+this.currentValue+" ["+this.minValue+" - "+this.maxValue+"]"}}]),e}(),Patch=function(){function e(t){_classCallCheck(this,e),this.patchName="",this.effects=new Array,this.listenner=Optional.empty(),this.id=t}return _createClass(e,[{key:"getId",value:function(){return id}},{key:"addEffect",value:function(e){this.effects.push(e),e.setListenner(this)}},{key:"setListenner",value:function(e){this.listenner=Optional.of(e)}},{key:"onChange",value:function(e){var t=new ChangeMessage(MultistompCause.SUPER,this,e);this.notify(t)}},{key:"notify",value:function(e){this.listenner.isPresent()&&this.listenner.get().onChange(e)}},{key:"toString",value:function(){return"Patch "+this.id+" - "+this.name+" ("+this.effects.length+") Effect(s))"}},{key:"name",get:function(){return this.patchName},set:function(e){this.patchName=e;var t=new Details(Details.TypeChange.PATCH_NAME,this.patchName),n=new ChangeMessage(MultistompCause.PATCH,this,t);this.notify(n)}}]),e}(),ChangeMessage=function(){function e(t,n,s){_classCallCheck(this,e),this.nextMessage=null,s instanceof e?this._constructorMessage(t,n,s):this._constructorDetails(t,n,s)}return _createClass(e,null,[{key:"None",value:function(t){return new e<Multistomp>(MultistompCause.NONE,Details.NONE())}},{key:"For",value:function(t,n){return new e<Multistomp>(MultistompCause.MULTISTOMP,n)}},{key:"For",value:function(t,n,s){var a=new e<Patch>(MultistompCause.PATCH,s),i=new e<Multistomp>(MultistompCause.SUPER,a);return i}},{key:"For",value:function(t,n,s,a){var i=new e<Effect>(MultistompCause.EFFECT,a),r=new e<Patch>(MultistompCause.SUPER,i),o=new e<Multistomp>(MultistompCause.SUPER,r);return o}},{key:"For",value:function(t,n,s,a,i){var r=new e<Param>(MultistompCause.PARAM,i),o=new e<Effect>(MultistompCause.SUPER,r),u=new e<Patch>(MultistompCause.SUPER,o),l=new e<Multistomp>(MultistompCause.SUPER,u);return l}}]),_createClass(e,[{key:"_constructorMessage",value:function(e,t,n){this._constructorDetails(e,t,Details.NONE()),this.nextMessage=n}},{key:"_constructorDetails",value:function(e,t,n){this.cause=e,this.causer=t,this.details=n}},{key:"details",value:function(e){function t(){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(){return details})},{key:"is",value:function(e){return e===this.realMessage().cause}},{key:"realMessage",value:function(){for(var e=this;e.cause==MultistompCause.SUPER;)e=e.nextMessage;return e}},{key:"toString",value:function(){var e="";return e+=this.causer.getClass().getSimpleName(),e+=this.cause==MultistompCause.SUPER?" -> "+this.nextMessage.toString():" ("+this.cause.toString()+")"}}]),e}(),Details=function(){function e(t,n){_classCallCheck(this,e),this.type=t,this.newValue=n}return _createClass(e,null,[{key:"NONE",value:function(){return new e(e.TypeChange.NONE,0)}}]),_createClass(e,[{key:"newValue",value:function(){return this.newValue}},{key:"type",value:function(){return this.type}},{key:"toString",value:function(){return"("+this.type+" "+this.newValue+")"}}]),e}();Details.TypeChange={NONE:"NONE",PEDAL_STATUS:"PEDAL_STATUS",PARAM:"PARAM",PATCH_NUMBER:"PATCH_NUMBER",PATCH_NAME:"PATCH_NAME"};var MultistompCause=function a(){_classCallCheck(this,a)};MultistompCause.SUPER="SUPER",MultistompCause.NONE="NONE",MultistompCause.MULTISTOMP="MULTISTOMP",MultistompCause.PATCH="PATCH",MultistompCause.EFFECT="EFFECT",MultistompCause.PARAM="PARAM";var MultistompFactory=function(){function e(){_classCallCheck(this,e)}return _createClass(e,null,[{key:"For",value:function(e){var t=void 0,n=e.getCompany();return t=n==PedalCompany.ZoomCorp?(new ZoomMultistompFactory).generate(e):n==PedalCompany.Roland?new NullMultistomp:(n==PedalCompany.Line6,new NullMultistomp)}}]),e}(),Log=function(){function e(t){_classCallCheck(this,e),this.type=t}return _createClass(e,[{key:"onChange",value:function(e){var t=!0,n=!1,s=void 0;try{for(var a,i=e[Symbol.iterator]();!(t=(a=i.next()).done);t=!0){var r=a.value;console.info("LOG:: "+this.type),console.log("LOG:: "+r.toString())}}catch(o){n=!0,s=o}finally{try{!t&&i["return"]&&i["return"]()}finally{if(n)throw s}}}}]),e}(),MultistompSimulator=function(e){function t(e){_classCallCheck(this,t),_get(Object.getPrototypeOf(t.prototype),"constructor",this).call(this);for(var n=0;e>n;n++){var s=new Patch(n),a=!0,i=!1,r=void 0;try{for(var o,u=this.genEffects()[Symbol.iterator]();!(a=(o=u.next()).done);a=!0){var l=o.value;s.addEffect(l)}}catch(c){i=!0,r=c}finally{try{!a&&u["return"]&&u["return"]()}finally{if(i)throw r}}this.addPatch(s)}}return _inherits(t,e),_createClass(t,[{key:"genEffects",value:function(){var e=new Array;return e.push(this.genEffect(0,"Overdrive")),e.push(this.genEffect(1,"Reverb")),e.push(this.genEffect(2,"Chorus")),e}},{key:"genEffect",value:function(e,t){var n=new Effect(e,t);return n.addParam(new Param("Gain",0,50,0,1)),n.addParam(new Param("Volume",0,25,0,1)),n}},{key:"start",value:function(){return new Messages}},{key:"getPedalType",value:function(){return PedalType.Null}}]),t}(Multistomp),NullMultistomp=function(e){function t(){_classCallCheck(this,t),_get(Object.getPrototypeOf(t.prototype),"constructor",this).call(this),this.MSG_ERROR="Pedal Unknown is unimplemented",this.addPatch(new Patch(0)),console.log(this.MSG_ERROR)}return _inherits(t,e),_createClass(t,[{key:"getPedalType",value:function(){return PedalType.Null}},{key:"start",value:function(){return new Messages}}]),t}(Multistomp),ZoomMultistompFactory=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"generate",value:function(e){return e==PedalType.G2Nu?new ZoomG2Nu:e==PedalType.G3?new ZoomGSeries(100,6,8):new ZoomGSeries(0,5,9)}}]),e}(),ZoomGSeries=function(e){function t(e,n,s){_classCallCheck(this,t),_get(Object.getPrototypeOf(t.prototype),"constructor",this).call(this),this.TOTAL_PATCHS=e,this.TOTAL_EFFECTS=n,this.SIZE_PARAMS=s;var a=this.createPatchs(this.TOTAL_PATCHS),i=!0,r=!1,o=void 0;try{for(var u,l=a[Symbol.iterator]();!(i=(u=l.next()).done);i=!0){var c=u.value;this.addPatch(c)}}catch(h){r=!0,o=h}finally{try{!i&&l["return"]&&l["return"]()}finally{if(r)throw o}}}return _inherits(t,e),_createClass(t,[{key:"createPatchs",value:function(e){for(var t=new Array,n=0;e>n;n++){var s=new Patch(n),a=!0,i=!1,r=void 0;try{for(var o,u=this.createEffects(this.TOTAL_EFFECTS)[Symbol.iterator]();!(a=(o=u.next()).done);a=!0){var l=o.value;s.addEffect(l)}}catch(c){i=!0,r=c}finally{try{!a&&u["return"]&&u["return"]()}finally{if(i)throw r}}t.push(s)}return t}},{key:"createEffects",value:function(e){for(var t=new Array,n=0;e>n;n++)t.push(ZoomGSeriesEffect.COMP.generate());return t}},{key:"start",value:function(){var e=new Messages;return e.concatWith(ZoomGSeriesMessages.LISSEN_ME()).concatWith(ZoomGSeriesMessages.YOU_CAN_TALK()),e}},{key:"getPedalType",value:function(){return PedalType.G3}}]),t}(Multistomp),ZoomGSeriesCause=function(e){function t(){_classCallCheck(this,t),_get(Object.getPrototypeOf(t.prototype),"constructor",this).apply(this,arguments)}return _inherits(t,e),t}(CommonCause);ZoomGSeriesCause.REQUEST_CURRENT_PATCH_NUMBER="REQUEST_CURRENT_PATCH_NUMBER",ZoomGSeriesCause.REQUEST_CURRENT_PATCH_DETAILS="REQUEST_CURRENT_PATCH_DETAILS",ZoomGSeriesCause.REQUEST_SPECIFIC_PATCH_DETAILS="REQUEST_SPECIFIC_PATCH_DETAILS",ZoomGSeriesCause.LISSEN_ME="LISSEN_ME",ZoomGSeriesCause.YOU_CAN_TALK="YOU_CAN_TALK",ZoomGSeriesCause.SET_EFFECT="SET_EFFECT";var ZoomGSeriesEffect=function(){function e(){_classCallCheck(this,e)}return _createClass(e,null,[{key:"COMP",value:new(function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"generate",value:function(){var e=new Effect(0,this.constructor.name);return e.addParam(new Param("Sense",0,10,6,1)),e.addParam(new Param("Tone",0,10,6,1)),e.addParam(new Param("Level",0,150,100,1)),e.addParam(new Param("ATTCK",0,1,0,1)),e}}]),e}()),enumerable:!0}]),e}(),ZoomGSeriesMessageDecoder=function(){function e(){_classCallCheck(this,e),this.decoders=new Array,this.decoders.push(new ZoomGSeriesPatchDecoder),this.decoders.push(new ZoomGSeriesSelectPatchDecoder)}return _createClass(e,[{key:"isForThis",value:function(e){return this.decodesFor(e).length>0}},{key:"decode",value:function(e,t){var n=this.decodesFor(e),s=new Messages;return n.forEach(function(n){return s.concatWith(n.decode(e,t))}),s}},{key:"decodesFor",value:function(e){var t=new Array,n=!0,s=!1,a=void 0;try{for(var i,r=this.decoders[Symbol.iterator]();!(n=(i=r.next()).done);n=!0){var o=i.value;o.isForThis(e)&&t.push(o)}}catch(u){s=!0,a=u}finally{try{!n&&r["return"]&&r["return"]()}finally{if(s)throw a}}return t}}]),e}(),ZoomGSeriesMessageEncoder=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"encode",value:function(e){var t=new MidiMessagesGenerator(e,this);return t.forEachOfType(CommonCause.TO_PATCH).generate(this.toPatchMessages),t.forEachOfType(CommonCause.ACTIVE_EFFECT).generate(this.statusEffectMessages),t.forEachOfType(CommonCause.DISABLE_EFFECT).generate(this.statusEffectMessages),t.forEachOfType(CommonCause.SET_PARAM).generate(this.setParamMessages),t.forEachOfType(ZoomGSeriesCause.SET_EFFECT).generate(this.setEffectMessages),t.forEachOfType(ZoomGSeriesCause.REQUEST_CURRENT_PATCH_NUMBER).generate(this.requestCurrentPatchNumberMessages),t.forEachOfType(ZoomGSeriesCause.REQUEST_CURRENT_PATCH_DETAILS).generate(this.requestCurrentPatchDetailsMessages),t.forEachOfType(ZoomGSeriesCause.REQUEST_SPECIFIC_PATCH_DETAILS).generate(this.requestSpecificPatchDetailsMessages),t.forEachOfType(ZoomGSeriesCause.LISSEN_ME).generate(this.lissenMeMessages),t.forEachOfType(ZoomGSeriesCause.YOU_CAN_TALK).generate(this.youCanTalkMessages),t.generateMidiMessages()}},{key:"toPatchMessages",value:function(e){var t=192,n=e.details.patch,s=new MidiMessage(t,n);return(new MidiMessages).add(s)}},{key:"statusEffectMessages",value:function(t,n){var s=t.details.effect,a=n==CommonCause.ACTIVE_EFFECT,i=a?1:0,r=this.manipuleEffectMessages(s,e.SET_STATUS,i);return(new MidiMessages).concatWith(this.lissenMeMessages()).concatWith(r)}},{key:"setParamMessages",value:function(t){var n=t.details.effect,s=t.details.param,a=t.details.value;return this.manipuleEffectMessages(n,s+e.PARAM_EFFECT,a)}},{key:"setEffectMessages",value:function(t){var n=t.details.effect,s=t.details.value;return this.manipuleEffectMessages(n,e.CHANGE_EFFECT,s)}},{key:"manipuleEffectMessages",value:function(e,t,n){var s=n/128|0;n%=128;var a=new MidiMessage(240,82,0,90,49,e,t,n,s,247);return(new MidiMessages).add(a)}},{key:"requestCurrentPatchNumberMessages",value:function(e){var t=new MidiMessage(240,82,0,90,51,247);return(new MidiMessages).add(t)}},{key:"requestCurrentPatchDetailsMessages",value:function(e){var t=new MidiMessage(240,82,0,90,41,247);return(new MidiMessages).add(t)}},{key:"requestSpecificPatchDetailsMessages",value:function(e){var t=e.details.patch,n=new MidiMessage(240,82,0,90,9,0,0,t,247);return(new MidiMessages).add(n)}},{key:"lissenMeMessages",value:function(){var e=new MidiMessage(240,82,0,90,80,247);return(new MidiMessages).add(e)}},{key:"youCanTalkMessages",value:function(){var e=new MidiMessage(240,82,0,90,22,247);return(new MidiMessages).add(e)}}],[{key:"SET_STATUS",value:0,enumerable:!0},{key:"CHANGE_EFFECT",value:1,enumerable:!0},{key:"PARAM_EFFECT",value:2,enumerable:!0}]),e}(),ZoomGSeriesMessages=function(){function e(){_classCallCheck(this,e)}return _createClass(e,null,[{key:"REQUEST_CURRENT_PATCH_NUMBER",value:function(){return(new Messages).add(new Messages.Message(ZoomGSeriesCause.REQUEST_CURRENT_PATCH_NUMBER))}},{key:"REQUEST_CURRENT_PATCH_DETAILS",value:function(){return(new Messages).add(new Messages.Message(ZoomGSeriesCause.REQUEST_CURRENT_PATCH_DETAILS))}},{key:"REQUEST_SPECIFIC_PATCH_DETAILS",value:function(e){var t=new Messages.Details;return t.patch=e,(new Messages).add(new Messages.Message(ZoomGSeriesCause.REQUEST_SPECIFIC_PATCH_DETAILS,t))}},{key:"LISSEN_ME",value:function(){return(new Messages).add(new Messages.Message(ZoomGSeriesCause.LISSEN_ME))}},{key:"YOU_CAN_TALK",value:function(){return(new Messages).add(new Messages.Message(ZoomGSeriesCause.YOU_CAN_TALK))}},{key:"SET_EFFECT",value:function(e,t){var n=new Messages.Details;return n.effect=e,n.value=t,(new Messages).add(new Messages.Message(ZoomGSeriesCause.SET_EFFECT,n))}}]),e}(),ZoomGSeriesPatchDecoder=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"isForThis",value:function(e){var t=120,n=new MidiMessageTester(e);return n.init().sizeIs(t).test()}},{key:"decode",value:function(e){var t=new Messages,n=new ZoomGSeriesPatchNameDecoder,s=new ZoomGSeriesPatchNumberDecoder,a=new ZoomGSeriesPatchEffectsDecoder;return t.concatWith(n.decode(e)).concatWith(s.decode(e)).concatWith(a.decode(e)),t}}]),e}(),ZoomGSeriesPatchEffectsDecoder=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"isForThis",value:function(e){return!0}},{key:"decode",value:function(e){var t=new Messages,n=new ZoomGSeriesPatchEffectsStatusDecoder;return t.concatWith(n.decode(e)),t}}]),e}(),ZoomGSeriesPatchEffectsStatusDecoder=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"isForThis",value:function(e){return!0}},{key:"decode",value:function(e){for(var t=[11,24,38,52,65,79],n=new Messages,s=0;s<t.length;s++){var a=t[s],i=this.hasActived(e,a);n.add(this.generateMessageFor(s,i))}return n}},{key:"hasActived",value:function(e,t){var n=1,s=e[t]&n;return 1==s}},{key:"generateMessageFor",value:function(e,t){var n=t?CommonCause.ACTIVE_EFFECT:CommonCause.DISABLE_EFFECT,s=new Messages.Message(n);return s.details.effect=e,s}}]),e}(),ZoomGSeriesPatchNameDecoder=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"isForThis",value:function(e){var t=new MidiMessageTester(e),n=t.init().sizeIs(120).test(),s=!1;return n||s}},{key:"decode",value:function(e){var t=new Messages.Message(CommonCause.PATCH_NAME);return t.details.value=this.getNameBy(e),(new Messages).add(t)}},{key:"getNameBy",value:function(t){for(var n=e.FIRST_LETTER,s=e.LAST_LETTER,a="",i=n;s>i;i++){var r=t[i];a+=String.fromCharCode(r)}return a}}],[{key:"FIRST_LETTER",value:102,enumerable:!0},{key:"LAST_LETTER",value:113,enumerable:!0}]),e}(),ZoomGSeriesPatchNumberDecoder=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"isForThis",value:function(e){var t=new MidiMessageTester(e);return t.init().sizeIs(120).test()}},{key:"decode",value:function(e){var t=this.getPatchNumber(e);return(new Messages).add(this.generateMessageFor(t))}},{key:"getPatchNumber",value:function(e){var t=7;return e[t]}},{key:"generateMessageFor",value:function(e){var t=new Messages.Message(CommonCause.PATCH_NUMBER);return t.details.patch=e,t}}]),e}(),ZoomGSeriesPedalsDecoder=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"isForThis",value:function(e){var t=new MidiMessageTester(e),n=t.init().sizeIs(120).test(),s=!1;return n||s}},{key:"decode",value:function(t,n){var s=(new Messages.Details,!0),a=!1,i=void 0;try{for(var r,o=e.PEDALS_INDEX[Symbol.iterator]();!(s=(r=o.next()).done);s=!0){var u=r.value,l=this.hasActived(t,u);console.log(t[u]-1,l,l?t[u]-1:t[u])}}catch(c){a=!0,i=c}finally{try{!s&&o["return"]&&o["return"]()}finally{if(a)throw i}}return new Messages}},{key:"hasActived",value:function(e,t){var n=1,s=e[t]&n;return 1==s}}],[{key:"PEDALS_INDEX",value:[8,24,38,52,65,79],enumerable:!0}]),e}(),ZoomGSeriesSelectPatchDecoder=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"isForThis",value:function(e){var t=[192],n=new MidiMessageTester(e);return n.init().sizeIs(2).startingWith(t).test()}},{key:"decode",value:function(t){var n=new Messages.Message(CommonCause.TO_PATCH);return n.details.patch=t[e.PATCH],(new Messages).add(n)}}],[{key:"PATCH",value:1,enumerable:!0}]),e}();